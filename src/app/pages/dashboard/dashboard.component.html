<!-- Main Content -->
<main class="flex flex-col lg:flex-row items-center justify-center pt-16 pb-24 px-6">


  <!-- Product Form -->
  <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="flex flex-col items-start lg:w-1/3">
    <h2 class="mb-16"></h2>
    <div class="flex flex-col gap-6 text-base sm:w-full">
      <!-- Número de referencia -->
      <div class="flex flex-col gap-3">
        <label for="reference" class="font-semibold">Nº Referencia</label>
        <input type="text" id="reference" formControlName="reference" placeholder="00001" autocomplete="off" class="p-2 rounded-lg border-2 border-gray-300" (change)="searchReference()">
        <!-- Validación de referencia -->
        <p *ngIf="productForm.get('reference')?.errors?.['required'] && productForm.get('reference')?.touched" class="text-red-600 font-medium">El número de referencia es obligatorio</p>
        <p *ngIf="productForm.get('reference')?.errors?.['minlength'] && productForm.get('reference')?.touched" class="text-red-600 font-medium">El número de referencia debe tener al menos 1 carácter</p>
        <p *ngIf="productForm.get('reference')?.errors?.['maxlength'] && productForm.get('reference')?.touched" class="text-red-600 font-medium">El número de referencia no puede tener más de 20 caracteres</p>
        <p *ngIf="productForm.get('reference')?.errors?.['uniqueReference'] && productForm.get('reference')?.touched" class="text-red-600 font-medium">El número de referencia debe comenzar por un número</p>
      </div>

      <!-- Modelo del dispositivo -->
      <div class="flex flex-col gap-3">
        <label for="name" class="font-semibold">Modelo</label>
        <input type="text" id="name" formControlName="name" placeholder="Galaxy Watch 6" autocomplete="off" class="p-2 rounded-lg border-2 border-gray-300">
        <!-- Validación de modelo -->
        <p *ngIf="productForm.get('name')?.errors?.['required'] && productForm.get('name')?.touched" class="text-red-600 font-medium">El modelo del dispositivo es obligatorio</p>
        <p *ngIf="productForm.get('name')?.errors?.['minlength'] && productForm.get('name')?.touched" class="text-red-600 font-medium">El modelo del dispositivo debe tener al menos 3 caracteres</p>
        <p *ngIf="productForm.get('name')?.errors?.['maxlength'] && productForm.get('name')?.touched" class="text-red-600 font-medium">El modelo del dispositivo no puede tener más de 50 caracteres</p>
      </div>

      <!-- Precio -->
      <div class="flex flex-col gap-3">
        <label for="price" class="font-semibold">Precio</label>
        <input type="number" id="price" formControlName="price" placeholder="999,99€" autocomplete="off" class="p-2 rounded-lg border-2 border-gray-300">
        <!-- Validación de precio -->
        <p *ngIf="productForm.get('price')?.errors?.['required'] && productForm.get('price')?.touched" class="text-red-600 font-medium">El precio es obligatorio</p>
        <p *ngIf="productForm.get('price')?.errors?.['min'] && productForm.get('price')?.touched" class="text-red-600 font-medium">El precio no puede ser negativo</p>
        <p *ngIf="productForm.get('price')?.errors?.['pattern'] && productForm.get('price')?.touched" class="text-red-600 font-medium">El precio debe ser un número válido con hasta 2 decimales</p>
      </div>

      <!-- Descripción -->
      <div class="flex flex-col gap-3">
        <label for="description" class="font-semibold">Descripción</label>
        <textarea id="description" formControlName="description" rows="6" placeholder="Reloj clásico, con las ventajas de un reloj inteligente" autocomplete="off" class="p-2 rounded-lg border-2 border-gray-300"></textarea>
        <!-- Validación de descripción -->
        <p *ngIf="productForm.get('description')?.errors?.['required'] && productForm.get('description')?.touched" class="text-red-600 font-medium">Se requiere descripción</p>
        <p *ngIf="productForm.get('description')?.errors?.['minlength'] && productForm.get('description')?.touched" class="text-red-600 font-medium">La descripción debe tener al menos 5 caracteres</p>
        <p *ngIf="productForm.get('description')?.errors?.['maxlength'] && productForm.get('description')?.touched" class="text-red-600 font-medium">La descripción no puede tener más de 500 caracteres</p>
      </div>

      <!-- Tipo de dispositivo -->
      <div class="flex flex-col gap-3">
        <label for="type" class="font-semibold">Tipo de dispositivo</label>
        <select id="type" formControlName="type" autocomplete="off" class="p-2 rounded-lg border-2 border-gray-300">
          <option value="" disabled selected>Selecciona el tipo de dispositivo</option>
          <option value="Componentes">Componentes</option>
          <option value="Portátiles">Portátiles</option>
          <option value="Smartphones">Smartphones</option>
          <option value="Monitores">Monitores</option>
          <option value="Hogar">Hogar</option>
        </select>
        <!-- Validación de tipo de dispositivo -->
        <p *ngIf="productForm.get('type')?.errors?.['required'] && productForm.get('type')?.touched" class="text-red-600 font-medium">El tipo de dispositivo es obligatorio</p>
      </div>

      <!-- Oferta de dispositivo -->
      <div class="flex items-center gap-3">
        <label for="offer" class="font-semibold cursor-pointer">Dispositivo en oferta</label>
        <input id="offer" type="checkbox" formControlName="offer" class="h-6 w-6 rounded-lg border-2 checked:bg-blue-500 cursor-pointer">
      </div>

      <!-- Agregar imagen del dispositivo -->
      <div class="flex flex-col gap-3">
        <label for="image" class="font-semibold">Imagen</label>
        <input type="file" id="image" formControlName="image" autocomplete="off" (change)="selectImage($event)" class="w-full text-gray-700 file:rounded-lg file:border-gray-300 file:bg-gray-200 file:px-4 file:py-2 file:shadow-md file:focus:border-blue-600 file:focus:ring-blue-600 cursor-pointer">
        <!-- Validación de imagen -->
        <p *ngIf="productForm.get('image')?.errors?.['required'] && productForm.get('image')?.touched" class="text-red-600 font-medium">Se requiere un archivo de imagen (JPG, JPEG, PNG)</p>
        <p *ngIf="productForm.get('image')?.errors?.['pattern'] && productForm.get('image')?.touched" class="text-red-600 font-medium">Tipo de archivo no válido. Sólo se permiten JPG, JPEG y PNG</p>
      </div>

      <div class="flex justify-end items-center pt-6 gap-4">
        <!-- Botón de envío y edición -->
        <button type="submit" [disabled]="productForm.invalid" class="py-3 px-6 border-transparent shadow-md font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700">
          {{isEditing? 'Editar Dispositivo' : 'Añadir Dispositivo'}}
        </button>

        <!-- Botón de limpiar formulario -->
        <button type="reset" class="py-3 px-6 border-transparent shadow-md font-medium rounded-lg text-white bg-gray-600 hover:bg-gray-700">
          Limpiar
        </button>
      </div>
    </div>
  </form>
</main>
